# angee.yaml — {{ .ProjectName }}
# Source of truth. Edit directly or ask your admin agent.
# Generated from: angee-base template
name: {{ .ProjectName }}

# ─── Platform services ────────────────────────────────────────────────────────

services:
  operator:
    image: ghcr.io/fyltr/angee-operator:latest
    lifecycle: system
    ports:
      - "9000:9000"
    raw_volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - .:/angee-root
    env:
      ANGEE_ROOT: /angee-root
    health:
      path: /health
      port: 9000
      interval: 10s
      timeout: 5s

  traefik:
    image: traefik:v3
    lifecycle: system
    ports:
      - "3333:80"
      - "443:443"
    raw_volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    command: >-
      traefik
      --providers.docker=true
      --providers.docker.exposedbydefault=false
      --entrypoints.web.address=:80
      --entrypoints.websecure.address=:443
      --api.dashboard=true
      --api.insecure=true
    volumes:
      - name: traefik-certs
        path: /certs
        persistent: true

# ─── MCP servers ─────────────────────────────────────────────────────────────

mcp_servers:

  angee-operator:
    transport: streamable-http
    url: http://operator:9000/mcp
    credentials:
      source: service_account
      scopes:
        - config.read
        - config.write
        - deploy
        - rollback
        - status
        - logs
        - scale
        - secrets.list

  angee-files:
    transport: stdio
    image: ghcr.io/fyltr/angee-filesystem-mcp:latest
    command:
      - node
      - /usr/local/lib/mcp-filesystem/dist/index.js
    args:
      - /workspace
    credentials:
      source: none
